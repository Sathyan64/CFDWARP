#include <stdio.h>
#include <stdlib.h>
#include <exm.h>

#include <math.h>

#define calR           8.314472e0
#define calA 6.02214199E23  

#define SMAP_eminus   0
#define SMAP_O2       1
#define SMAP_N2       2
#define SMAP_O        3
#define SMAP_N        4
#define SMAP_O2plus   5
#define SMAP_N2plus   6
#define SMAP_Oplus    7
#define SMAP_Nplus    8
#define SMAP_O2minus  9
#define SMAP_Ominus  10
#define SMAP_O3      11
#define SMAP_N2A     12
#define SMAP_NO      13
#define SMAP_NOplus  14

#define ns 5
#define ns_c 15

#define speceminus 0
#define specN2 1
#define specN2plus 2
#define specO2 3
#define specO2plus 4

const static long smap[ns] = {
  SMAP_eminus,
  SMAP_N2,
  SMAP_N2plus,
  SMAP_O2,
  SMAP_O2plus
};


const static double calM[ns_c]=
  {
   5.4858E-7,    /* e- */
   31.9988e-3,   /* O2 */
   28.0134e-3,   /* N2 */
   15.9994e-3,   /* O */
   14.0067e-3,   /* N */
   31.99825e-3,  /* O2+ */
   28.01285e-3,  /* N2+ */
   15.99885e-3,  /* O+ */
   14.00615e-3,  /* N+ */
   31.99935e-3,  /* O2- */   
   15.99995e-3,  /* O- */    
   47.99820e-3,  /* O3 */    
   28.01340e-3,  /* N2(A) */    
   30.00610e-3,  /* NO */    
   30.00555e-3   /* NO+ */    
  };


const static double Pa[ns_c][3][11]=
  {

/* These polynomials come from a paper by McBride and Gordon:

	NASA Glenn Coefficients for Calculating Thermodynamic Properties
	of Individual Species (2002), NASA-TP-2002-211556, september 2002

*/

/* species e-
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    

    {
      {
       +298.15e0,        /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       +0.0e0,           /* a1 */
       +0.0e0,           /* a2 */
       +2.5e0,           /* a3 */
       +0.0e0,           /* a4 */
       +0.0e0,           /* a5 */
       +0.0e0,           /* a6 */
       +0.0e0,           /* a7 */
       -7.45375e+2,      /* b1 */
       -1.172081224e+1   /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +0.0e0,           /* a1 */
       +0.0e0,           /* a2 */
       +2.5e0,           /* a3 */
       +0.0e0,           /* a4 */
       +0.0e0,           /* a5 */
       +0.0e0,           /* a6 */
       +0.0e0,           /* a7 */
       -7.45375e+2,      /* b1 */
       -1.172081224e+1   /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +0.0e0,           /* a1 */
       +0.0e0,           /* a2 */
       +2.5e0,           /* a3 */
       +0.0e0,           /* a4 */
       +0.0e0,           /* a5 */
       +0.0e0,           /* a6 */
       +0.0e0,           /* a7 */
       -7.45375e+2,      /* b1 */
       -1.172081224e+1   /* b2 */        
      }
    },

    
/* species O2
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +200.0e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       -3.425563420e+04, /* a1 */
       +4.847000970e+02, /* a2 */
       +1.119010961e+00, /* a3 */
       +4.293889240e-03, /* a4 */
       -6.836300520e-07, /* a5 */
       -2.023372700e-09, /* a6 */
       +1.039040018e-12, /* a7 */
       -3.391454870e+03, /* b1 */
       +1.849699470e+01  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       -1.037939022e+06, /* a1 */
       +2.344830282e+03, /* a2 */
       +1.819732036e+00, /* a3 */
       +1.267847582e-03, /* a4 */
       -2.188067988e-07, /* a5 */
       +2.053719572e-11, /* a6 */
       -8.193467050e-16, /* a7 */
       -1.689010929e+04, /* b1 */
       +1.738716506e+01  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +4.975294300e+08, /* a1 */
       -2.866106874e+05, /* a2 */
       +6.690352250e+01, /* a3 */
       -6.169959020e-03, /* a4 */
       +3.016396027e-07, /* a5 */
       -7.421416600e-12, /* a6 */
       +7.278175770e-17, /* a7 */
       +2.293554027e+06, /* b1 */
       -5.530621610e+02  /* b2 */        
      }
    },
    
  
/* species N2
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +200.0e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       +2.210371497e+04, /* a1 */
       -3.818461820e+02, /* a2 */
       +6.082738360e+00, /* a3 */
       -8.530914410e-03, /* a4 */
       +1.384646189e-05, /* a5 */
       -9.625793620e-09, /* a6 */
       +2.519705809e-12, /* a7 */
       +7.108460860e+02, /* b1 */
       -1.076003744e+01  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +5.877124060e+05, /* a1 */
       -2.239249073e+03, /* a2 */
       +6.066949220e+00, /* a3 */
       -6.139685500e-04, /* a4 */
       +1.491806679e-07, /* a5 */
       -1.923105485e-11, /* a6 */
       +1.061954386e-15, /* a7 */
       +1.283210415e+04, /* b1 */
       -1.586640027e+01  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +8.310139160e+08, /* a1 */
       -6.420733540e+05, /* a2 */
       +2.020264635e+02, /* a3 */
       -3.065092046e-02, /* a4 */
       +2.486903333e-06, /* a5 */
       -9.705954110e-11, /* a6 */
       +1.437538881e-15, /* a7 */
       +4.938707040e+06, /* b1 */
       -1.672099740e+03  /* b2 */        
      }
    },
  

/* species O
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +200.0e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       -7.953611300e+03, /* a1 */
       +1.607177787e+02, /* a2 */
       +1.966226438e+00, /* a3 */
       +1.013670310e-03, /* a4 */
       -1.110415423e-06, /* a5 */
       +6.517507500e-10, /* a6 */
       -1.584779251e-13, /* a7 */
       +2.840362437e+04, /* b1 */
       +8.404241820e+00  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +2.619020262e+05, /* a1 */
       -7.298722030e+02, /* a2 */
       +3.317177270e+00, /* a3 */
       -4.281334360e-04, /* a4 */
       +1.036104594e-07, /* a5 */
       -9.438304330e-12, /* a6 */
       +2.725038297e-16, /* a7 */
       +3.392428060e+04, /* b1 */
       -6.679585350e-01  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +1.779004264e+08, /* a1 */
       -1.082328257e+05, /* a2 */
       +2.810778365e+01, /* a3 */
       -2.975232262e-03, /* a4 */
       +1.854997534e-07, /* a5 */
       -5.796231540e-12, /* a6 */
       +7.191720164e-17, /* a7 */
       +8.890942630e+05, /* b1 */
       -2.181728151e+02  /* b2 */        
      }
    },
  
  
  
/* species N
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +200.0e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       +0.000000000e+00, /* a1 */
       +0.000000000e+00, /* a2 */
       +2.500000000e+00, /* a3 */
       +0.000000000e+00, /* a4 */
       +0.000000000e+00, /* a5 */
       +0.000000000e+00, /* a6 */
       +0.000000000e+00, /* a7 */
       +5.610463780e+04, /* b1 */
       +4.193905036e+00  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +8.876501380e+04, /* a1 */
       -1.071231500e+02, /* a2 */
       +2.362188287e+00, /* a3 */
       +2.916720081e-04, /* a4 */
       -1.729515100e-07, /* a5 */
       +4.012657880e-11, /* a6 */
       -2.677227571e-15, /* a7 */
       +5.697351330e+04, /* b1 */
       +4.865231506e+00  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +5.475181050e+08, /* a1 */
       -3.107574980e+05, /* a2 */
       +6.916782740e+01, /* a3 */
       -6.847988130e-03, /* a4 */
       +3.827572400e-07, /* a5 */
       -1.098367709e-11, /* a6 */
       +1.277986024e-16, /* a7 */
       +2.550585618e+06, /* b1 */
       -5.848769753e+02  /* b2 */        
      }
    },
  
  
  
  
/* species O2+
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +298.15e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       -8.607205450e+04, /* a1 */
       +1.051875934e+03, /* a2 */
       -5.432380470e-01, /* a3 */
       +6.571166540e-03, /* a4 */
       -3.274263750e-06, /* a5 */
       +5.940645340e-11, /* a6 */
       +3.238784790e-13, /* a7 */
       +1.345544668e+05, /* b1 */
       +2.902709750e+01  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +7.384654880e+04, /* a1 */
       -8.459559540e+02, /* a2 */
       +4.985164160e+00, /* a3 */
       -1.611010890e-04, /* a4 */
       +6.427083990e-08, /* a5 */
       -1.504939874e-11, /* a6 */
       +1.578465409e-15, /* a7 */
       +1.446321044e+05, /* b1 */
       -5.811230650e+00  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       -1.562125524e+09, /* a1 */
       +1.161406778e+06, /* a2 */
       -3.302504720e+02, /* a3 */
       +4.710937520e-02, /* a4 */
       -3.354461380e-06, /* a5 */
       +1.167968599e-10, /* a6 */
       -1.589754791e-15, /* a7 */
       -8.857866270e+06, /* b1 */
       +2.852035602e+03  /* b2 */        
      }
    },
  
  
    
/* species N2+
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +298.15e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       -3.474047470e+04, /* a1 */
       +2.696222703e+02, /* a2 */
       +3.164916370e+00, /* a3 */
       -2.132239781e-03, /* a4 */
       +6.730476400e-06, /* a5 */
       -5.637304970e-09, /* a6 */
       +1.621756000e-12, /* a7 */
       +1.790004424e+05, /* b1 */
       +6.832974166e+00  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       -2.845599002e+06, /* a1 */
       +7.058893030e+03, /* a2 */
       -2.884886385e+00, /* a3 */
       +3.068677059e-03, /* a4 */
       -4.361652310e-07, /* a5 */
       +2.102514545e-11, /* a6 */
       +5.411996470e-16, /* a7 */
       +1.340388483e+05, /* b1 */
       +5.090897022e+01  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       -3.712829770e+08, /* a1 */
       +3.139287234e+05, /* a2 */
       -9.603518050e+01, /* a3 */
       +1.571193286e-02, /* a4 */
       -1.175065525e-06, /* a5 */
       +4.144441230e-11, /* a6 */
       -5.621893090e-16, /* a7 */
       -2.217361867e+06, /* b1 */
       +8.436270947e+02  /* b2 */        
      }
    },

/* species O+
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +298.15e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       +0.000000000e+00, /* a1 */
       +0.000000000e+00, /* a2 */
       +2.500000000e+00, /* a3 */
       +0.000000000e+00, /* a4 */
       +0.000000000e+00, /* a5 */
       +0.000000000e+00, /* a6 */
       +0.000000000e+00, /* a7 */
       +1.879352842e+05, /* b1 */
       +4.393376760e+00  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       -2.166513208e+05, /* a1 */
       +6.665456150e+02, /* a2 */
       +1.702064364e+00, /* a3 */
       +4.714992810e-04, /* a4 */
       -1.427131823e-07, /* a5 */
       +2.016595903e-11, /* a6 */
       -9.107157762e-16, /* a7 */
       +1.837191966e+05, /* b1 */
       +1.005690382e+01  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       -2.143835383e+08, /* a1 */
       +1.469518523e+05, /* a2 */
       -3.680864540e+01, /* a3 */
       +5.036164540e-03, /* a4 */
       -3.087873854e-07, /* a5 */
       +9.186834870e-12, /* a6 */
       -1.074163268e-16, /* a7 */
       -9.614208960e+05, /* b1 */
       +3.426193080e+02  /* b2 */        
      }
    },
      
  

/* 
   species N+ 
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +298.15e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       +5.237079210e+03, /* a1 */
       +2.299958315e+00, /* a2 */
       +2.487488821e+00, /* a3 */
       +2.737490756e-05, /* a4 */
       -3.134447576e-08, /* a5 */
       +1.850111332e-11, /* a6 */
       -4.447350984e-15, /* a7 */
       +2.256284738e+05, /* b1 */
       +5.076830786e+00  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +2.904970374e+05, /* a1 */
       -8.557908610e+02, /* a2 */
       +3.477389290e+00, /* a3 */
       -5.288267190e-04, /* a4 */
       +1.352350307e-07, /* a5 */
       -1.389834122e-11, /* a6 */
       +5.046166279e-16, /* a7 */
       +2.310809984e+05, /* b1 */
       -1.994146545e+00  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +1.646092148e+07, /* a1 */
       -1.113165218e+04, /* a2 */
       +4.976986640e+00, /* a3 */
       -2.005393583e-04, /* a4 */
       +1.022481356e-08, /* a5 */
       -2.691430863e-13, /* a6 */
       +3.539931593e-18, /* a7 */
       +3.136284696e+05, /* b1 */
       -1.706646380e+01  /* b2 */        
      }
    },
      
  
        
/* 
   species O2-
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +298.15e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       +1.883874344e+04, /* a1 */
       +1.149551768e+02, /* a2 */
       +1.518876821e+00, /* a3 */
       +8.016111380e-03, /* a4 */
       -9.850571030e-06, /* a5 */
       +6.044196210e-09, /* a6 */
       -1.486439845e-12, /* a7 */
       -7.101538760e+03, /* b1 */
       +1.501210380e+01  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +5900.0e0,        /* Tmax [K] */
       -5.655208050e+04, /* a1 */
       -2.367815862e+02, /* a2 */
       +4.675833670e+00, /* a3 */
       -2.197245300e-05, /* a4 */
       +1.711509280e-08, /* a5 */
       -1.757645062e-12, /* a6 */
       +8.248172790e-17, /* a7 */
       -5.960177750e+03, /* b1 */
       -2.436885556e+00  /* b2 */        
      },
      {
       +5900.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       -5.655208050e+04, /* a1 */
       -2.367815862e+02, /* a2 */
       +4.675833670e+00, /* a3 */
       -2.197245300e-05, /* a4 */
       +1.711509280e-08, /* a5 */
       -1.757645062e-12, /* a6 */
       +8.248172790e-17, /* a7 */
       -5.960177750e+03, /* b1 */
       -2.436885556e+00  /* b2 */        
      }
    },

/* 
   species O-
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +298.15e0,        /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       -5.695857110e+03, /* a1 */
       +1.099287334e+02, /* a2 */
       +2.184719661e+00, /* a3 */
       +5.326359800e-04, /* a4 */
       -5.298878440e-07, /* a5 */
       +2.870216236e-10, /* a6 */
       -6.524692740e-14, /* a7 */
       +1.093287498e+04, /* b1 */
       +6.729863860e+00  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +9.769363180e+03, /* a1 */
       +7.159604780e+00, /* a2 */
       +2.494961726e+00, /* a3 */
       +1.968240938e-06, /* a4 */
       -4.304174850e-10, /* a5 */
       +4.912083080e-14, /* a6 */
       -2.271600083e-18, /* a7 */
       +1.149554438e+04, /* b1 */
       +4.837036440e+00  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +5.662391000e+02, /* a1 */
       +7.572340320e+00, /* a2 */
       +2.498352500e+00, /* a3 */
       +1.862632395e-07, /* a4 */
       -1.151227211e-11, /* a5 */
       +3.688814210e-16, /* a6 */
       -4.793297600e-21, /* a7 */
       +1.148426000e+04, /* b1 */
       +4.813406590e+00  /* b2 */        
      }
    },
    
/* 
   species O3
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +200.00e0,        /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       -1.282314507e+04, /* a1 */
       +5.898216640e+02, /* a2 */
       -2.547496763e+00, /* a3 */
       +2.690121526e-02, /* a4 */
       -3.528258340e-05, /* a5 */
       +2.312290922e-08, /* a6 */
       -6.044893270e-12, /* a7 */
       +1.348368701e+04, /* b1 */
       +3.852218580e+01  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +5900.0e0,        /* Tmax [K] */
       -3.869662480e+07, /* a1 */
       +1.023344994e+05, /* a2 */
       -8.961551600e+01, /* a3 */
       +3.706144970e-02, /* a4 */
       -4.137638740e-06, /* a5 */
       -2.725018591e-10, /* a6 */
       +5.248188110e-14, /* a7 */
       -6.517918180e+05, /* b1 */
       +7.029109520e+02  /* b2 */        
      },
      {
       +5900.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       -3.869662480e+07, /* a1 */
       +1.023344994e+05, /* a2 */
       -8.961551600e+01, /* a3 */
       +3.706144970e-02, /* a4 */
       -4.137638740e-06, /* a5 */
       -2.725018591e-10, /* a6 */
       +5.248188110e-14, /* a7 */
       -6.517918180e+05, /* b1 */
       +7.029109520e+02  /* b2 */        
      }
    },

/* 
   species N2(A)  -> set to N2 for the time being
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +200.0e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       +2.210371497e+04, /* a1 */
       -3.818461820e+02, /* a2 */
       +6.082738360e+00, /* a3 */
       -8.530914410e-03, /* a4 */
       +1.384646189e-05, /* a5 */
       -9.625793620e-09, /* a6 */
       +2.519705809e-12, /* a7 */
       +7.108460860e+02, /* b1 */
       -1.076003744e+01  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +5.877124060e+05, /* a1 */
       -2.239249073e+03, /* a2 */
       +6.066949220e+00, /* a3 */
       -6.139685500e-04, /* a4 */
       +1.491806679e-07, /* a5 */
       -1.923105485e-11, /* a6 */
       +1.061954386e-15, /* a7 */
       +1.283210415e+04, /* b1 */
       -1.586640027e+01  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +8.310139160e+08, /* a1 */
       -6.420733540e+05, /* a2 */
       +2.020264635e+02, /* a3 */
       -3.065092046e-02, /* a4 */
       +2.486903333e-06, /* a5 */
       -9.705954110e-11, /* a6 */
       +1.437538881e-15, /* a7 */
       +4.938707040e+06, /* b1 */
       -1.672099740e+03  /* b2 */        
      }
    },
    
/* 
   species NO  
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +200.0e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       -1.143916503e+04, /* a1 */
       +1.536467592e+02, /* a2 */
       +3.431468730e+00, /* a3 */
       -2.668592368e-03, /* a4 */
       +8.481399120e-06, /* a5 */
       -7.685111050e-09, /* a6 */
       +2.386797655e-12, /* a7 */
       +9.098214410e+03, /* b1 */
       +6.728725490e+00  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +2.239018716e+05, /* a1 */
       -1.289651623e+03, /* a2 */
       +5.433936030e+00, /* a3 */
       -3.656034900e-04, /* a4 */
       +9.880966450e-08, /* a5 */
       -1.416076856e-11, /* a6 */
       +9.380184620e-16, /* a7 */
       +1.750317656e+04, /* b1 */
       -8.501669090e+00  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       -9.575303540e+08, /* a1 */
       +5.912434480e+05, /* a2 */
       -1.384566826e+02, /* a3 */
       +1.694339403e-02, /* a4 */
       -1.007351096e-06, /* a5 */
       +2.912584076e-11, /* a6 */
       -3.295109350e-16, /* a7 */
       -4.677501240e+06, /* b1 */
       +1.242081216e+03  /* b2 */        
      }
    },
    
/* 
   species NO+  
   pos 0: Tmin lower range limit
   pos 1: Tmax upper range limit
   pos 2-8: a1,a2,...,a7
   pos 9-10: b1,b2
*/    
    {
      {
       +298.15e0,         /* Tmin [K] */ 
       +1000.0e0,        /* Tmax [K] */
       +1.398106635e+03, /* a1 */
       -1.590446941e+02, /* a2 */
       +5.122895400e+00, /* a3 */
       -6.394388620e-03, /* a4 */
       +1.123918342e-05, /* a5 */
       -7.988581260e-09, /* a6 */
       +2.107383677e-12, /* a7 */
       +1.187495132e+05, /* b1 */
       -4.398433810e+00  /* b2 */
      },
      {
       +1000.0e0,        /* Tmin [K] */ 
       +6000.0e0,        /* Tmax [K] */
       +6.069876900e+05, /* a1 */
       -2.278395427e+03, /* a2 */
       +6.080324670e+00, /* a3 */
       -6.066847580e-04, /* a4 */
       +1.432002611e-07, /* a5 */
       -1.747990522e-11, /* a6 */
       +8.935014060e-16, /* a7 */
       +1.322709615e+05, /* b1 */
       -1.519880037e+01  /* b2 */        
      },
      {
       +6000.0e0,        /* Tmin [K] */ 
       +20000.0e0,       /* Tmax [K] */
       +2.676400347e+09, /* a1 */
       -1.832948690e+06, /* a2 */
       +5.099249390e+02, /* a3 */
       -7.113819280e-02, /* a4 */
       +5.317659880e-06, /* a5 */
       -1.963208212e-10, /* a6 */
       +2.805268230e-15, /* a7 */
       +1.443308939e+07, /* b1 */
       -4.324044462e+03 /* b2 */        
      }
    }

    
        
        
  };


  
static void find_Pa_index(long spec, double *T, long *index, double *dTplus){
  long cnt;
  *dTplus=0.0;
  *index=0;
  for (cnt=0; cnt<=2; cnt++) {
    if (*T>=Pa[smap[spec]][cnt][0] && *T<=Pa[smap[spec]][cnt][1]) {
      *index=cnt;
    } 
  }  
  if (*T<=Pa[smap[spec]][0][0]) {
    *dTplus=*T-Pa[smap[spec]][0][0];
    *T=Pa[smap[spec]][0][0];
    *index=0;
  }
  if (*T>=Pa[smap[spec]][2][1]) {
    *dTplus=*T-Pa[smap[spec]][2][1];
    *T=Pa[smap[spec]][2][1];
    *index=2;
  }
}
  
  
double _hk_from_T(long spec, double T){
  double tmp,dTplus;
  long index;
  
  find_Pa_index(spec, &T,&index,&dTplus);  
  
  tmp=calR*T/calM[smap[spec]]*(
             -Pa[smap[spec]][index][2]/T/T
             +Pa[smap[spec]][index][3]*log(T)/T
             +Pa[smap[spec]][index][4]
             +Pa[smap[spec]][index][5]*T/2.0e0+
             +Pa[smap[spec]][index][6]*T*T/3.0e0+
             +Pa[smap[spec]][index][7]*T*T*T/4.0e0+
             +Pa[smap[spec]][index][8]*T*T*T*T/5.0e0+
             +Pa[smap[spec]][index][9]/T
	     );
	 
	     
	         
  
  return(tmp);
}


int main(){
  double T,Qion;
  double N,rhoh_N2,rhoh_N2plus,rhoh_eminus,rhoh_O2,rhoh_O2plus;
  // rho = N calM / calA
  T=10000.0;
  N=1e20;
  
  rhoh_N2=N*calM[smap[specN2]]/calA*_hk_from_T(specN2,T);
  rhoh_N2plus=N*calM[smap[specN2plus]]/calA*_hk_from_T(specN2plus,T);
  rhoh_eminus=N*calM[smap[speceminus]]/calA*_hk_from_T(speceminus,T);
  Qion=(rhoh_N2plus+rhoh_eminus-rhoh_N2);
  printf("Qion/N=%E eV  (N2->N2plus+eminus)\n",Qion/N/1.602e-19);
  Qion=(rhoh_N2plus-rhoh_N2);
  printf("Qion/N=%E eV  (N2->N2plus)\n",Qion/N/1.602e-19);
  
  rhoh_O2=N*calM[smap[specO2]]/calA*_hk_from_T(specO2,T);
  rhoh_O2plus=N*calM[smap[specO2plus]]/calA*_hk_from_T(specO2plus,T);
  rhoh_eminus=N*calM[smap[speceminus]]/calA*_hk_from_T(speceminus,T);
  Qion=(rhoh_O2plus+rhoh_eminus-rhoh_O2);
  printf("Qion/N=%E eV  (O2->O2plus+eminus)\n",Qion/N/1.602e-19);
  Qion=(rhoh_O2plus-rhoh_O2);
  printf("Qion/N=%E eV  (O2->O2plus)\n",Qion/N/1.602e-19);

  printf("NN2overN_air=%E\n",1.0/(((calM[smap[specN2]])/0.765 - calM[smap[specN2]])/calM[smap[specO2]]+1.0));  
  printf("NO2overN_air=%E\n",1.0/(((calM[smap[specO2]])/0.235 - calM[smap[specO2]])/calM[smap[specN2]]+1.0));  
  return(1);
}

